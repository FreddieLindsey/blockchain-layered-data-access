\subsubsection{Group Permissions}

\paragraph{Extending Individual Access Control}

Group permissions extend the above system for individual permissions and require the use of smart contracts.

Whilst our application is intended to be fully decentralised, the key stakeholders for some applications (such as health care) may require access to the network to administrate. One example of this is the involvement of the GMC in validating doctor identities. If a doctor has not been registered, or has been struck off, they should not have any access to patient data (even if they claim to be a doctor). They should only have access should the GMC validate that they are in fact a valid doctor.

The idea of a group administrator, such as the GMC, conflicts with the idea of the data owner maintaining full access control and administration. However, should the data owner decide that the group should no longer have any access or wishes to change group permissions, they are able to do so.

To facilitate this, let's take a look at the architecture of a group's interactions with a particular identity's contract.

\input{tikz/architecture/group_interactions}

An identity claiming to be a member of a group will always interact with the storage contract it is trying to retrieve from or add data to. A group itself will never be able to directly affect or transact with a storage contract such that no malicious attacker would be able to pseudo-anonymously act as the group.

When the identity tries to access a path, their identity is cross-checked with the group they claim to be a member of. Should this group validate the identity as a member, and assuming the group has the necessary permissions that are required to action the identity's transaction, the transaction will be successful.

\paragraph{Group Key Sharing}

Whilst the process of writing data is similar to an individual (other than the membership validation above), the process of reading data differs hugely for groups.

If we were to extend the process of reading as an individual to a group, the result would be a process similar to that shown in figure \ref{fig:encryption_group_read_theoretical}.

\input{tikz/encryption/group_read}

Given the non-transitive nature of the proxy re-encryption scheme we are using, the process shown in figure \ref{fig:encryption_group_read_theoretical} doesn't allow end-to-end encryption. After the first stage of re-encryption, $\text{Data}_{G}$ represents a first-level encryption under the group $G$'s public key. Since the proxy re-encryption scheme being used only allows re-encryption from a second-level encryption to a first-level encryption (to eliminate transitivity), no further action is possible. Another process is required to facilitate group read.

Given only one re-encryption is possible, we look to the identity that the re-encryption is for. We ask ourselves whether the original (individual) scheme could work here, and indeed it could, although it comes with many flaws including:

\begin{itemize}
  \item 
  	\textbf{Non-optimal key storage} \\
    For every member of the group, a re-encryption key must be generated by the storage contract owner. The process of generating a re-encryption key for every member is $O(n)$, i.e. for a group with a membership of 50, 50 re-encryption keys need to be generated.
  % TODO: Need more here    
\end{itemize}

As an improvement to individual keys, let's take a look at the viability of the theoretical group read process. Assume that there is a group key pair, for which any data received by a member of the group from a storage contract is encrypted. Now all data is encrypted such that the group private key is required to decrypt it. The group private key is encrypted using the group public key such that it can only be decrypted by itself. The administrator of the group must therefore hold the re-encryption key from the group private key to their public key in order to read, and therefore administer, the group. When a member joins the group, the administrator creates a re-encryption key for them such that they are able to decrypt the group's private key when re-encrypted. However, when a member leaves the group, the reference to their re-encryption key is removed from the group contract.

In contrast to figure \ref{fig:encryption_group_read_theoretical}, the process of receiving data as a member of the group now follows a process similar to that shown in figure \ref{fig:encryption_group_read_practical}.

\input{tikz/encryption/group_read_practical}
