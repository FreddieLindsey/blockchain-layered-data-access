\subsection{Data Layering}

We have a system which is able to support end-to-end encryption of data with permissions and access control. As an extension of this, we briefly consider how this data might be layered such that different parties see different views of data.

As an example, take the following JSON object in program code \ref{code:patient_record_json}. Let's assume this represents a record of a patient visiting a general practitioner.

\input{code/PatientRecordJson}

Now let's split the JSON object into three further JSON objects corresponding to the "doctor", "metadata", and "notes" properties. We could also do the same to the "doctor" and "metadata" objects. This would result in five separate JSON objects which, when combined, form the original JSON object. This is a recursively applied process.

\subsubsection{Storing data chunks}

Since the structure of a JSON object is representative of a tree, when evaluated as above, we can use this property to visualise the data as a file system:

\input{figures/json_file_structure}

The use of the suffix '.part' hints at an file representing a property of the parent JSON object. We can transform the tree in figure \ref{fig:json_file_structure} into a Merkle tree by taking the hash of each file. Given the file content in program code \ref{code:patient_record_json} the resulting Merkle tree is shown in figure \ref{tikz:json_merkle_tree}.

\input{tikz/json_merkle_tree}

\subsubsection{Permissions for data chunks}
