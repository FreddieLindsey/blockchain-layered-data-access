\begin{figure}[H]
  \centering
  \begin{minted}{java}
public byte[] reencrypt() {
  // Split the input data into the encrypted key and encrypted data
  Tuple<byte[]> dataPackets = splitPackets();

  // Reencrypt the symmetric key using the given re-encryption key
  byte[] encryptedKey = asymmetricReencrypt(dataPackets.getFirst(), reencryptionKey);

  // Generate ciphertext from the encrypted symmetric key
  // and the data encrypted with the symmetric key
  byte[] ciphertext = mergeByteArrays(encryptedKey, symmetricKeyData.getSecond());

  return ciphertext;
}
  \end{minted}
  \caption{Reencrypting data}
  \label{code:reencrypt_data}
\end{figure}
